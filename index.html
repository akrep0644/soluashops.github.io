
AnladÄ±m. Ä°stediÄŸin, sadece VPN ve Proxy IP'lerini engellemek deÄŸil, aynÄ± zamanda **Goodbye DPI** gibi trafiÄŸi ÅŸifreleyerek veya maskeleyerek engelleri aÅŸmaya Ã§alÄ±ÅŸan araÃ§larÄ± da tespit eden bir sistem. Bu, standart IP kontrollerinin Ã¶tesine geÃ§erek daha derinlemesine bir analiz gerektirir.

Ä°ÅŸte bu amaÃ§la oluÅŸturulmuÅŸ, Ã§ok daha katÄ± ve katmanlÄ± bir engelleme sistemi:

### Sistem NasÄ±l Ã‡alÄ±ÅŸÄ±r?

1.  **IP TabanlÄ± Ä°lk Filtreleme**: Ã–nceki kod gibi, IP adresinin bilinen bir VPN, proxy veya veri merkezi olup olmadÄ±ÄŸÄ±nÄ± kontrol eder.
2.  **TLS Parmak Ä°zi (JA3/JA3S) KontrolÃ¼**: Her TLS (gÃ¼venli web trafiÄŸi) oturumunun kendine Ã¶zgÃ¼ bir "parmak izi" vardÄ±r. Goodbye DPI gibi araÃ§lar, bu parmak izini deÄŸiÅŸtirerek kendini belli eder. Sunucu tarafÄ±nda bu kontrolÃ¼ yapmak zordur ancak istemci tarafÄ±nda (JavaScript ile) bazÄ± dolaylÄ± yollarla tespit edilebilir. **Ancak en etkili yÃ¶ntem sunucu tarafÄ±dÄ±r.**
3.  **HTTP BaÅŸlÄ±klarÄ±nÄ± (Headers) Analiz Etme**: Normal bir tarayÄ±cÄ±dan gelen isteklerde belirli baÅŸlÄ±klar (`User-Agent`, `Accept-Language`, `Sec-Ch-Ua` vb.) standart bir formatta gelir. Goodbye DPI gibi araÃ§lar veya Ã¶zel betikler bu baÅŸlÄ±klarÄ± deÄŸiÅŸtirebilir, eksik bÄ±rakabilir veya anlamsÄ±z deÄŸerler atayabilir. Bu, en kolay ve en etkili istemci-tarafÄ± tespit yÃ¶ntemlerinden biridir.
4.  **JavaScript TabanlÄ± DavranÄ±ÅŸsal Testler**: GerÃ§ek bir tarayÄ±cÄ± ortamÄ±nÄ± test ederiz. Ã–rneÄŸin, `navigator` objesinin belirli Ã¶zelliklerini kontrol ederiz. Basit bir komut dosyasÄ± veya araÃ§ bu ortamÄ± tam olarak taklit edemez.
5.  **Cloudflare Turnstile (En GÃ¼Ã§lÃ¼ YÃ¶ntem)**: EÄŸer siten Cloudflare kullanÄ±yorsa, Turnstile'i etkinleÅŸtirmek en etkili Ã§Ã¶zÃ¼mdÃ¼r. Turnstile, CAPTCHA'ya ihtiyaÃ§ duymadan, kullanÄ±cÄ± davranÄ±ÅŸlarÄ±nÄ± analiz ederek bot ve otomatik araÃ§larÄ± (Goodbye DPI gibi) anÄ±nda tespit eder.

AÅŸaÄŸÄ±daki kod, bu yÃ¶ntemlerden (1, 3 ve 4) istemci tarafÄ±nda uygulanabilenleri birleÅŸtirerek Ã§ok daha gÃ¼Ã§lÃ¼ bir engelleme mekanizmasÄ± sunar.

---

### GeliÅŸmiÅŸ Engelleme Kodu

Bu kod, HTTP baÅŸlÄ±klarÄ±nÄ± ve tarayÄ±cÄ± ortamÄ±nÄ± inceler. ÅÃ¼pheli bir durum tespit ederse kullanÄ±cÄ±yÄ± engeller ve Discord'a bildirir.

```html
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>GeliÅŸmiÅŸ GÃ¼venlik KontrolÃ¼</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #0a0a0a; color: #eaeaea; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { background: #111; border: 1px solid #333; border-radius: 12px; padding: 40px; width: 90%; max-width: 550px; box-shadow: 0 0 30px rgba(0, 0, 0, 0.5); text-align: center; }
        h1 { margin-top: 0; }
        p { font-size: 16px; line-height: 1.6; }
        .allowed { color: #00ff88; border-color: #00ff88; }
        .allowed h1 { color: #00ff88; }
        .loading { color: #ffa500; }
        .blocked { color: #ff4d4d; border-color: #ff4d4d; }
        .blocked h1 { color: #ff4d4d; }
    </style>
</head>
<body>

    <div id="content" class="container loading">
        <h1>GÃ¼venlik KontrolÃ¼ YapÄ±lÄ±yor...</h1>
        <p>LÃ¼tfen bekleyin. BaÄŸlantÄ±nÄ±zÄ±n gÃ¼venliÄŸi doÄŸrulanÄ±yor.</p>
    </div>

    <script>
        const webhookUrl = "https://discord.com/api/webhooks/1454212443227033762/sENFhwWgklT-lvcuHVyZrg0l634v00ce4tSz3YsVM6HXTMtOMZzNAlvUVFjyo3ekswyJ";
        const contentDiv = document.getElementById('content');

        // --- TESPÄ°T FONKSÄ°YONLARI ---

        // 1. HTTP BaÅŸlÄ±klarÄ±nÄ± Analiz Et
        function isSuspiciousHeaders() {
            const userAgent = navigator.userAgent;
            // Ã‡ok kÄ±sa veya anlamsÄ±z User-Agent
            if (!userAgent || userAgent.length < 10 || !userAgent.includes("Mozilla")) {
                return "AnlamsÄ±z veya eksik User-Agent.";
            }
            // Common bot/tool User-Agents
            if (userAgent.includes("curl") || userAgent.includes("wget") || userAgent.includes("python-requests")) {
                return "ÅÃ¼pheli User-Agent tespit edildi.";
            }
            return null;
        }

        // 2. TarayÄ±cÄ± OrtamÄ±nÄ± Test Et
        function isSuspiciousEnvironment() {
            // Chrome DevTools Protocol gibi araÃ§lar window.chrome objesini deÄŸiÅŸtirebilir.
            if (window.chrome && window.chrome.runtime && window.chrome.runtime.onConnect) {
                 // Bu her zaman bir ÅŸÃ¼phe iÅŸareti deÄŸildir ama bazÄ± otomasyon araÃ§larÄ±nda gÃ¶rÃ¼lÃ¼r.
                 // Daha spesifik kontroller eklenebilir.
            }

            // PhantomJS gibi eski headless tarayÄ±cÄ±lar window.callPhantom objesi ekler.
            if (window.callPhantom || window.phantom) {
                return "Headless tarayÄ±cÄ± tespit edildi (PhantomJS).";
            }

            // GerÃ§ek bir tarayÄ±cÄ±da olmasÄ± gereken ama bazÄ± betiklerde olmayan objeler.
            const hasEssentialBrowserFeatures = !!window.document && !!window.navigator && !!window.history;
            if (!hasEssentialBrowserFeatures) {
                return "Temel tarayÄ±cÄ± Ã¶zellikleri eksik.";
            }
            
            // WebDriver Ã¶zelliÄŸi, Selenium gibi otomasyon araÃ§larÄ±nÄ±n varlÄ±ÄŸÄ±nÄ± belli eder.
            if (navigator.webdriver) {
                return "WebDriver (Otomasyon AracÄ±) tespit edildi.";
            }

            return null;
        }

        // 3. IP Kontrolleri
        async function checkIp(ip) {
            try {
                // ipapi.co, proxy ve hosting bilgilerini de saÄŸlar
                const response = await fetch(`https://ipapi.co/${ip}/json/`);
                if (!response.ok) throw new Error("IP API'den cevap alÄ±namadÄ±.");
                const data = await response.json();
                if (data.proxy === true || data.hosting === true) {
                    return "IP adresi VPN, Proxy veya Veri Merkezi olarak iÅŸaretlendi.";
                }
            } catch (error) {
                console.error("IP kontrol hatasÄ±:", error);
                return "IP kontrolÃ¼ sÄ±rasÄ±nda hata.";
            }
            return null;
        }

        // --- ANA Ä°ÅLEMLER ---

        async function sendBlockNotification(reason, data) {
            const payload = {
                content: "ğŸš¨ **GeliÅŸmiÅŸ GÃ¼venlik Engellemesi!**",
                embeds: [{
                    title: "ÅÃ¼pheli Aktivite Tespit Edildi",
                    color: 16711680,
                    fields: [
                        { name: "Engelleme Sebebi", value: `\`\`\`${reason}\`\`\``, inline: false },
                        ...(data.ip ? [{ name: "IP Adresi", value: `\`\`\`${data.ip}\`\`\``, inline: true }] : []),
                        ...(data.city ? [{ name: "Åehir", value: `\`\`\`${data.city}\`\`\``, inline: true }] : []),
                        ...(data.country ? [{ name: "Ãœlke", value: `\`\`\`${data.country}\`\`\``, inline: true }] : []),
                        ...(data.org ? [{ name: "ISP/Org", value: `\`\`\`${data.org}\`\`\``, inline: false }] : []),
                        { name: "User-Agent", value: `\`\`\`${navigator.userAgent.substring(0, 200)}\`\`\``, inline: false }
                    ],
                    timestamp: new Date().toISOString()
                }]
            };
            try { await fetch(webhookUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) }); } catch (e) {
